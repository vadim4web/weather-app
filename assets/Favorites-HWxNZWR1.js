import{r as l,o as h,w as k,a as w,b as a,c as s,F as S,d as N,e as D,t as m,f as y,g as I,h as u,i as P,j as O,k as g,l as F,_ as J,m as W,P as b,n as B}from"./index-Z0BFZP_s.js";const L={key:0},V={key:0,class:"content favorites"},$={key:1},j={style:{padding:"1rem"}},x={key:1,class:"wrapper"},U={__name:"Favorites",setup(C){const n=l(!1),_=l(sessionStorage.getItem("favsDays")||1),o=l(JSON.parse(localStorage.getItem("favorites"))||[]),v=async()=>{if(n.value=!1,localStorage.getItem("favorites")){const t=JSON.parse(localStorage.getItem("favorites")),d=t.map(e=>e.city.name),i=t.map(async e=>await O(e.city.name)),c=await Promise.all(i);g.global.messages.en.cityNamesPinned=d.join("_"),g.global.messages.uk.cityNamesPinned=c.join("_");const r=new Date().toISOString().slice(0,10),f=t.map(async e=>{if(!e.weather||e.weather.current.time.slice(0,10)!==r){const p=await F(e.city.latitude,e.city.longitude);e.weather=p}return e});localStorage.setItem("favorites",JSON.stringify(await Promise.all(f)))}o.value=JSON.parse(localStorage.getItem("favorites"))||[],n.value=!0};return h(()=>{v()}),k(JSON.parse(localStorage.getItem("favorites")),()=>window.location.reload()),(t,d)=>{const i=w("router-link");return n.value===!0?(a(),s("div",L,[o.value.length?(a(),s("div",V,[(a(!0),s(S,null,N(o.value,(c,r)=>(a(),u(J,{key:r,cityWeather:c,displayDays:_.value,index:r},null,8,["cityWeather","displayDays","index"]))),128))])):(a(),s("div",$,[D("h2",j,m(t.$t("noPinned")),1),y(i,{to:"/"},{default:I(()=>[W(m(t.$t("backToHome")),1)]),_:1})])),o.value.length?(a(),u(B,{key:2,less:1,more:7,storageKey:"favsDays"})):P("",!0)])):(a(),s("div",x,[y(b)]))}}};export{U as default};
